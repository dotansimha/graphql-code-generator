---
title: Plugins
---
import { Plugins } from '@/components/plugins'
import { PACKAGES } from '@/lib/plugins'
import { CategoryToPackages } from '@/category-to-packages.mjs';

export const getStaticProps = async () => {
  const categoryEntries = Object.entries(CategoryToPackages);
  const plugins = await Promise.all(
    PACKAGES.map(async ({ npmPackage, identifier, iconUrl, tags }) => {
      const encodedName = encodeURIComponent(npmPackage)
      const [
        {
          readme,
          time: { created, modified },
          description
        },
        { downloads },
      ] = await Promise.all([
        fetch(`https://registry.npmjs.org/${encodedName}`).then(response => response.json()),
        fetch(`https://api.npmjs.org/downloads/point/last-week/${encodedName}`).then(response => response.json())
      ])
      const [category] = categoryEntries.find(([, pluginName]) => pluginName.includes(identifier)) || []
      const linkHref = `/plugins/${category}/${identifier}`
      return {
        title: npmPackage,
        readme,
        created,
        modified,
        description,
        linkHref,
        weeklyNPMDownloads: downloads,
        iconUrl,
        tags,
      }
    })
  )
  return {
    props: {
      // We add an `ssg` field to the page props,
      // which will be provided to the Nextra's `useSSG` hook.
      ssg: plugins
    },
    // Revalidate at most once every 1 hour
    revalidate: 60 * 60
  }
}

<Plugins />
